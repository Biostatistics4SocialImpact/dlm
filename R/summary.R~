

## from lme4:
print.summary.merMod <- function (
    x, digits = max(3, getOption("digits") - 3), correlation = NULL,
    symbolic.cor = FALSE, signif.stars = getOption("show.signif.stars"),
    ranef.comp = c("Variance", "Std.Dev."), show.resids = TRUE,
    ...)
{
    .prt.methTit(x$methTitle, x$objClass)
    .prt.family(x)
    .prt.call(x$call)
    cat("\n")
    .prt.aictab(x$AICtab)
    cat("\n")
    if (show.resids)
        .prt.resids(x$residuals, digits = digits)
    .prt.VC(x$varcor, digits = digits, useScale = x$useScale,
        comp = ranef.comp, ...)
    .prt.grps(x$ngrps, nobs = x$devcomp$dims[["n"]])
    p <- nrow(x$coefficients)
    if (p > 0) {
        cat("\nFixed effects:\n")
        printCoefmat(x$coefficients, zap.ind = 3, digits = digits,
            signif.stars = signif.stars)
        hasCor <- !is.null(VC <- x$vcov) && !is.null(VC@factors$correlation)
        if (is.null(correlation)) {
            cor.max <- getOption("lme4.summary.cor.max")
            correlation <- hasCor && p <= cor.max
            if (!correlation && p > cor.max) {
                nam <- deparse(substitute(x))
                if (length(nam) > 1 || nchar(nam) >= 32)
                  nam <- "...."
                message(sprintf(paste("\nCorrelation matrix not shown by default, as p = %d > %d.",
                  "Use print(%s, correlation=TRUE)  or", "\t vcov(%s)\t if you need it\n",
                  sep = "\n"), p, cor.max, nam, nam))
            }
        }
        else if (!is.logical(correlation))
            stop("'correlation' must be NULL or logical")
        if (correlation) {
            if (is.null(VC))
                VC <- vcov(x, correlation = TRUE)
            corF <- VC@factors$correlation
            if (is.null(corF)) {
                message("\nCorrelation of fixed effects could have been required in summary()")
                corF <- cov2cor(VC)
            }
            p <- ncol(corF)
            if (p > 1) {
                rn <- rownames(x$coefficients)
                rns <- abbreviate(rn, minlength = 11)
                cat("\nCorrelation of Fixed Effects:\n")
                if (is.logical(symbolic.cor) && symbolic.cor) {
                  corf <- as(corF, "matrix")
                  dimnames(corf) <- list(rns, abbreviate(rn,
                    minlength = 1, strict = TRUE))
                  print(symnum(corf))
                }
                else {
                  corf <- matrix(format(round(corF@x, 3), nsmall = 3),
                    ncol = p, dimnames = list(rns, abbreviate(rn,
                      minlength = 6)))
                  corf[!lower.tri(corf)] <- ""
                  print(corf[-1, -p, drop = FALSE], quote = FALSE)
                }
            }
        }
    }
    if (length(x$fitMsgs) && any(nchar(x$fitMsgs) > 0)) {
        cat("fit warnings:\n")
        writeLines(x$fitMsgs)
    }
    .prt.warn(x$optinfo, summary = FALSE)
    invisible(x)
}

